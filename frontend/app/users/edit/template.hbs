{{#if (can "read user" this.model)}}
  <header class="user-header border-b grid">
    <div class="user-header-info">
      <h1
        class="text-5xl md:text-6xl text-foreground text-center"
      >{{this.model.fullName}}</h1>
    </div>

    {{#if this.data.isRunning}}
      <div
        class="user-header-loading grid place-self-center place-items-center w-full"
      >
        <LoadingIcon />
      </div>
    {{else}}
      {{#unless this.model.activeEmployment.isExternal}}
        <h2
          class="user-header-worktime-balance-title text-2xl md:text-3xl uppercase text-center text-foreground-muted"
        >Worktime balance</h2>

        <div
          class="user-header-worktime-balance-container grid grid-cols-2 md:grid-cols-[minmax(0,0.9fr),minmax(0,2.2fr),minmax(0,0.9fr)] lg:grid-cols-[auto,minmax(0,0.8fr),auto] lg:gap-2 w-full lg:w-3/4 max-w-[48rem] xl:max-w-[52rem] place-self-center px-8 sm:px-16 md:px-0 mb-5"
        >
          <div
            class="user-header-worktime-balance-last-valid-timesheet text-center justify-self-end w-full self-center max-md:text-left md:-translate-y-4 max-md:px-2"
          >
            {{#let
              this.data.lastSuccessful.value.worktimeBalanceLastValidTimesheet
              as |balance|
            }}
              <h2
                title="Last day with timesheet entries or absences"
                class="text-foreground-muted uppercase text-base sm:text-lg md:text-xl lg:text-2xl"
              >
                {{moment-format balance.date "DD.MM.YYYY"}}
              </h2>
              <div
                class="{{balance-highlight-class balance.balance}}
                  text-xl sm:text-2xl md:text-3xl lg:text-4xl"
              >
                {{format-duration balance.balance false}}
              </div>
            {{/let}}
          </div>

          {{#if (media "isMd")}}
            <div class="user-header-worktime-balance">
              <WorktimeBalanceChart
                @worktimeBalances={{this.data.lastSuccessful.value.worktimeBalances}}
              />
            </div>
          {{/if}}

          <div
            class="user-header-worktime-balance-today text-center justify-self-start w-full self-center max-md:text-right md:-translate-y-4 max-md:px-2"
          >
            {{#let
              this.data.lastSuccessful.value.worktimeBalanceToday
              as |balance|
            }}
              <h2
                class="text-foreground-muted uppercase text-base sm:text-lg md:text-xl lg:text-2xl"
              >Today</h2>
              <div
                class="{{balance-highlight-class balance.balance}}
                  text-xl sm:text-2xl md:text-3xl lg:text-4xl"
              >
                {{format-duration balance.balance false}}
              </div>
            {{/let}}
          </div>

          {{#unless (media "isMd")}}
            <div class="user-header-worktime-balance col-span-2">
              <WorktimeBalanceChart
                @worktimeBalances={{this.data.lastSuccessful.value.worktimeBalances}}
              />
            </div>
          {{/unless}}
        </div>

        <div
          class="user-header-absence-balance-container flex-row flex-wrap flex justify-around md:justify-between max-w-[48rem] xl:max-w-[52rem] place-self-center w-full md:px-8 lg:px-9 xl:px-10 transition-[padding,max-width] mb-2 transition-all"
        >
          {{#let this.data.lastSuccessful.value.absenceBalances as |balances|}}
            {{#each balances as |balance index|}}
              <BalanceDonut
                @balance={{balance}}
                @class="user-header-absence-balance"
                @title={{balance.absenceType.name}}
                @index={{index}}
                @count={{balances.length}}
              />
            {{/each}}
          {{/let}}
        </div>
      {{/unless}}
    {{/if}}

  </header>

  <nav class="user-navigation border-b shadow-sm">
    <ul
      class="grid-cols-[repeat(3,auto)] grid justify-center [&>li>a]:text-foreground-muted [&>li>a]:block [&>li>a]:py-2 [&>li>a]:px-6 [&>li>a.active]:text-primary [&>li>a.active]:shadow-[inset_0_-2px_0] [&>li>a.active]:shadow-primary text-xl"
    >
      <li><LinkTo
          @route="users.edit.index"
          @model={{this.model.id}}
        >General</LinkTo></li>
      <li><LinkTo
          @route="users.edit.credits"
          @model={{this.model.id}}
        >Credits</LinkTo></li>
      <li><LinkTo
          @route="users.edit.responsibilities"
          @model={{this.model.id}}
        >Responsibilities</LinkTo></li>
    </ul>
  </nav>

  <section class="user-content pt-1 md:pt-2 lg:pt-3">
    {{outlet}}
  </section>
{{else}}
  <NoPermission />
{{/if}}